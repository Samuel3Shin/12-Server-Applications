# http module을 이용한 여러 서버들

보는 순서
plainServer -> restServer -> cookie -> cluster

실행 명령어 (우선 각각 폴더에 들어가서!)<br>
$ node "서버 코드 이름".js <br>

## /plainSerer
서버는 클라이언트의 요청을 받고, 이에 응답을 한다.
그러므로 클라이언트로부터 요청이 왔을 때, 어떤 작업을 수행할지 이벤트 리스너를 미리 등록해두어야한다.

서버에 요청을 보낼 때는 주소를 통해 요청의 내용을 표현한다. 
주소가 /index.html 이면 서버의 index.html 을 보내달라는 뜻이다.
그러나 항상 html만 요청할 필요는 없다. css나 js 또는 이미지 같은 파일을 요청할 수도 있고, 특정 동작을 행하도록 요청할 수 있다.

## /restSerer
이때 REST가 등장한다!
요청의 내용이 주소를 통해 표현되므로 서버가 이해하기 쉬운 주소를 사용하는 것이 좋은 것이다.

REST: REpresentational State Transfer
서버의 자원을 정의하고 자원에 대한 주소를 지정하는 방법을 가리킨다. 일종의 약속이다.
주소는 명사로 구성된다. 
/user이면 사용자 정보에 관련된 자원을 요청, /post라면 게시글에 관련된 자원을 요청하는 것이라 추측할 수 있다.

REST는 주소 외에도 HTTP 요청 메서드를 사용한다. (게시판 서버를 예로 들어서)
- GET: 포스트 본문 내용 가져올 때
- POST: 새로운 포스트를 등록할 때
- PUT: 포스트 본문 내용을 전체 다 새로운 내용으로 치환할 때
- PATCH: 본문의 일부만 수정할 때
- DELETE: 포스트를 삭제할 때

예를 들어, GET 메서드로 /user 주소로 요청을 보내면, 사용자 정보를 가져오는 요청
POST 메서드로 /user 주소로 요청을 보내면 새로운 사용자를 등록하는 요청이라는 것을 알 수 있다.

## /cookie
서버 입장에서는 클라이언트에서 보내는 요청이 누구의 요청인지 어떻게 알 수 있을까?
IP 주소나 브라우저 정보로 알 수 있을까? No!
여러 컴퓨터가 공통의 IP 주소를 가지거나, 한 컴퓨터를 여러 사람이 사용할 수 있기 때문에 아니다.

그렇다. 로그인을 해야한다.
로그인을 구현하기 위해서는 쿠키와 세션에 대해 알고 있어야 한다.

인터넷을 이용하는 네가 누구인지 기억하기 위해 서버는 요청에 대한 응답을 할 때 쿠키를 같이 보낸다.
쿠키는 name=samuel 같이 단순한 '키-값'의 쌍이다.
서버로부터 쿠키가 오면 웹 브라우저는 쿠키를 저장해두었다가 다음에 요청할 때마다 쿠키를 동봉해서 보낸다.
서버는 이 쿠키를 읽어서 사용자가 누구인지 파악한다.

쿠키는 요청의 헤더에 담겨 전송된다.
그러므로 쿠키는 F12 키를 눌렀을 때 나오는 네트워크 정보탭에 다 노출된다. -> 개인정보 유출의 위험이 있다!

이 문제를 해결하기 위해 '세션'이 나온다. (/cookie/session.js 를 참고!)
session은 하나의 변수인데, 이 변수 안에 사용자 정보를 저장하고, 클라이언트와는 session 아이디로 통신하는 것이다.
이 예제에서는 session을 변수로 만들어서 서버 코드에 저장했지만, session은 보통 Redis나 Memcached 같은 데이터베이스에 넣어둔다.

## /plainSerer/server1-3.js과 /plainSerer/server1-4.js
https 모듀을은 웹 서버에 SSL 암호화를 추가한다.
GET이나 POST 요청을 할 때 오가는 데이터를 암호화해서 중간에 다른 사람이 요청을 가로채더라도 내용을 확인할 수 없게 만든다. 

## /cluster
코어가 8개인 서버가 있을 때, 노드는 보통 하나의 코어만을 활용한다.
하지만 cluster 모듈과 함께라면, 코어 하나당 노드 프로세스 하나가 돌아가게 할 수 있다. 하지만 이 경우 메모리를 공유하지 못한다는 단점이 있다. 
여기서는 cluster 모듈로 클러스터링을 구현했지만, 실무에서는 pm2 등의 모듈로 cluster를 사용한다.

